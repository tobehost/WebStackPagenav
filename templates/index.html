{% extends "base.html" %}

{% block content %}
<!-- skin-white -->
<div class="page-container">
    <div class="sidebar-menu toggle-others fixed">
        <div class="sidebar-menu-inner">
            <header class="logo-env">
                <!-- logo -->
                <div class="logo">
                    <a href="{{ url_for('main.index') }}" class="logo-expanded">
                        <img src="{{ url_for('static', filename='images/logo@2x.png') }}" width="100%" alt="" />
                    </a>
                    <a href="{{ url_for('main.index') }}" class="logo-collapsed">
                        <img src="{{ url_for('static', filename='images/logo-collapsed@2x.png') }}" width="40" alt="" />
                    </a>
                </div>
                <div class="mobile-menu-toggle visible-xs">
                    <a href="#" data-toggle="user-info-menu">
                        <i class="linecons-cog"></i>
                    </a>
                    <a href="#" data-toggle="mobile-menu">
                        <i class="fa-bars"></i>
                    </a>
                </div>
            </header>
            
            <ul id="main-menu" class="main-menu">
                {% for item in categories_with_links %}
                <li>
                    <a href="#{{ item.category.name }}" class="smooth">
                        <i class="{{ item.category.icon }}"></i>
                        <span class="title">{{ item.category.name }}</span>
                    </a>
                </li>
                {% endfor %}
                <li>
                    <a href="{{ url_for('auth.login'), '_blank' }}">
                        <i class="linecons-heart"></i>
                        <span class="tooltip-blue">管理后台</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    
    <div class="main-content">
        <nav class="navbar user-info-navbar" role="navigation">
            <ul class="user-info-menu left-links list-inline list-unstyled">
                <li class="hidden-sm hidden-xs">
                    <a href="#" data-toggle="sidebar">
                        <i class="fa-bars"></i>
                    </a>
                </li>
            </ul>
            <ul class="user-info-menu right-links list-inline list-unstyled">
                {% if current_user.is_authenticated %}
                <li class="hidden-sm hidden-xs">
                    <a href="{{ url_for('main.logout') }}">
                        <i class="fa-user"></i> 退出登录
                    </a>
                </li>
                {% else %}
                <li class="hidden-sm hidden-xs">
                    <a href="{{ url_for('auth.login') ,'_blank' }}">
                        <i class="fa-user"></i> 管理员登录
                    </a>
                </li>
                {% endif %}
            </ul>
        </nav>

        <!-- 内容区域 -->
        {% for item in categories_with_links %}
        <h4 class="text-gray">
            <i class="linecons-tag" style="margin-right: 7px;" id="{{ item.category.name }}"></i>
            {{ item.category.name }}
        </h4>
        
        <div class="row">
            {% for link in item.links %}
            <div class="col-sm-3">
                <div class="xe-widget xe-conversations box2 label-info" 
                     onclick="window.open('{{ link.url }}', '_blank')" 
                     data-toggle="tooltip" 
                     data-placement="bottom" 
                     title="" 
                     data-original-title="{{ link.url }}">
                    <div class="xe-comment-entry">
                        <a class="xe-user-img">
                            <img data-src="{{ url_for('static', filename=link.logo) }}" 
                                 class="lozad img-circle" width="40" alt="{{ link.title }}">
                        </a>
                        {% if link.is_hot %}
                        <span class="label label-pink" data-toggle="tooltip" data-placement="left" title="热门推荐"></span>
                        {% endif %}
                        <div class="xe-comment">
                            <a href="#" class="xe-user-name overflowClip_1">
                                <strong>{{ link.title }}</strong>
                            </a>
                            <p class="overflowClip_2">{{ link.description }}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            {% if loop.index % 4 == 0 and not loop.last %}
            </div>
            <div class="row">
            {% endif %}
            {% endfor %}
        </div>
        <br />
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// 平滑滚动
$(document).ready(function(){
    $('a.smooth').on('click', function(event) {
        if (this.hash !== "") {
            event.preventDefault();
            var hash = this.hash;
            $('html, body').animate({
                scrollTop: $(hash).offset().top
            }, 800, function(){
                window.location.hash = hash;
            });
        }
    });
});

// 图片懒加载
if (typeof lozad !== 'undefined') {
    const observer = lozad();
    observer.observe();
}
</script>
{% endblock %}
